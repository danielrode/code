#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# author: Daniel Rode
# name: XLSX to CSV
# created: 17 Nov 2025
# updated: -


"""Convert Excel spreadsheets to CSV and print to stdout.
"""


import sys
from io import StringIO
from pathlib import Path

import pandas as pd


# Main
xlsx = Path(sys.argv[1])
try:
    sheet_name = sys.argv[2]
except IndexError:
    sheet_name = 0

with xlsx.open('rb') as f:
    df = pd.read_excel(f, sheet_name=sheet_name)

with StringIO() as f:
    df.to_csv(f, index=False)
    f.seek(0)
    print(f.read())
